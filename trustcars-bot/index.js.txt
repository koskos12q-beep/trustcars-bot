import TelegramBot from "node-telegram-bot-api";
import express from "express";

const TOKEN = process.env.BOT_TOKEN;
const bot = new TelegramBot(TOKEN, { polling: true });

const app = express();
app.use(express.static("web"));

app.get("/", (_, res) => {
  res.send("TrustCars bot is running");
});

bot.onText(/\/start/, (msg) => {
  bot.sendMessage(msg.chat.id,
    "Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ Ð² TrustCars ðŸš—\n\nÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³ Ð°Ð²Ñ‚Ð¾:",
    {
      reply_markup: {
        inline_keyboard: [
          [{
            text: "ðŸš˜ ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³",
            web_app: { url: "https://YOUR-APP-URL.up.railway.app" }
          }]
        ]
      }
    }
  );
});

bot.on("contact", (msg) => {
  bot.sendMessage(
    msg.chat.id,
    "Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾! Ð’Ð°ÑˆÐ° Ð·Ð°ÑÐ²ÐºÐ° Ð¿Ñ€Ð¸Ð½ÑÑ‚Ð°. Ð’ Ð±Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐµÐµ Ð²Ñ€ÐµÐ¼Ñ Ñ Ð²Ð°Ð¼Ð¸ ÑÐ²ÑÐ¶ÐµÑ‚ÑÑ Ð½Ð°Ñˆ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€."
  );
});

const PORT = process.env.PORT || 3000;
app.listen(PORT, () => console.log("Server started"));